<!DOCTYPE html>
<html lang='ja'>

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>BraceBracket</title>
  <link rel="stylesheet" href="css/style.css" />
  <link href="https://api.fontshare.com/css?f[]=satoshi@1,2&display=swap" rel="stylesheet">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@100;300;400;500;700;900&display=swap" rel="stylesheet">
</head>

<body>
  <div class="next_setting">
    <!-- 試合情報設定 表示しない場合はクラスにdisableを追加 -->
    <img class="board" src="image/upnext.png" alt=""><!-- 試合情報のデザインの画像 -->
    <p id="nextnow"></p>
    <div class="next_statusbox">
      <p id="next_round"></p>
      <p id="next_bo"></p>
    </div>
    <p class="next_player" id="next_playerleft"></p>
    <p id="next_scoreleft"></p>
    <p id="next_scoreright"></p>
    <p class="next_player" id="next_playerright"></p>
    <p id="localsetting">Local Time<br>JST</p>
    <p id="localtime"></p>
  </div>
</body>
<script>
//ローカルのjsonもしくはGASのAPIのURL（Google Spreadsheetを使う場合は各自変更してください。）
const endpoint = "localscore.json";


//APIを使って非同期データを取得する
function remoteBreak() {
  const xhr = new XMLHttpRequest();
  xhr.open("GET", endpoint);
  xhr.send();
  xhr.onreadystatechange = function() {
    //JSONから配列に変換
    const data = JSON.parse(xhr.response);
    console.log(data);
    var nextnow = data[2]['option'];
    console.log(nextnow);
    if (nextnow == 'NOW') {
      document.getElementById("nextnow").innerHTML = data[2]['option'];
      document.getElementById("next_scoreleft").innerHTML = data[0]['score'];
      document.getElementById("next_scoreright").innerHTML = data[1]['score'];
      document.getElementById("next_playerleft").innerHTML = data[0]['name'];
      document.getElementById("next_playerright").innerHTML = data[1]['name'];
      document.getElementById("next_round").innerHTML = data[0]['status'];
      document.getElementById("next_bo").innerHTML = data[1]['status'];
    } else if (nextnow == 'NEXT') {
      document.getElementById("nextnow").innerHTML = data[2]['option'];
      document.getElementById("next_scoreleft").innerHTML = data[2]['score'];
      document.getElementById("next_scoreright").innerHTML = data[3]['score'];
      document.getElementById("next_playerleft").innerHTML = data[2]['name'];
      document.getElementById("next_playerright").innerHTML = data[3]['name'];
      document.getElementById("next_round").innerHTML = data[2]['status'];
      document.getElementById("next_bo").innerHTML = data[3]['status'];
    }
    //inputタグそれぞれに取得したデータを設定
  }
}
remoteBreak();
window.setInterval(remoteBreak, 5000);
</script>
<script>
function timeSet() {
  var localTime = new Date();
  var hour = localTime.getHours(); // 時
  var min = localTime.getMinutes(); // 分
  if (hour < 10) { hour = "0" + hour; }
  if (min < 10) { min = "0" + min; }
  document.getElementById("localtime").innerHTML = (hour + ':' + min)
}
timeSet();
window.setInterval(timeSet, 3000);
</script>

</html>